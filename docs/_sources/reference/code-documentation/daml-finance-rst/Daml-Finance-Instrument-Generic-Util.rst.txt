.. Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
.. SPDX-License-Identifier: Apache-2.0

.. _module-daml-finance-instrument-generic-util-13331:

Module Daml.Finance.Instrument.Generic.Util
===========================================

Functions
---------

.. _function-daml-finance-instrument-generic-util-rollpaymentschedule-39668:

`rollPaymentSchedule <function-daml-finance-instrument-generic-util-rollpaymentschedule-39668_>`_
  \: :ref:`PeriodicSchedule <type-daml-finance-interface-types-date-schedule-periodicschedule-97930>` \-\> \[`Text <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-text-51952>`_\] \-\> `Party <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-party-57932>`_ \-\> `Party <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-party-57932>`_ \-\> `Update <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-update-68072>`_ :ref:`Schedule <type-daml-finance-interface-types-date-schedule-schedule-17285>`
  
  Retrieve holiday calendar(s) from the ledger and roll out the payment schedule\.

.. _function-daml-finance-instrument-generic-util-prepareandtagclaims-93565:

`prepareAndTagClaims <function-daml-finance-instrument-generic-util-prepareandtagclaims-93565_>`_
  \: \[Claim `Date <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-date-32253>`_ `Decimal <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-decimal-18135>`_ :ref:`Deliverable <type-daml-finance-interface-claims-types-deliverable-19293>` :ref:`Observable <type-daml-finance-interface-claims-types-observable-47872>`\] \-\> `Text <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-text-51952>`_ \-\> :ref:`TaggedClaim <type-daml-finance-interface-claims-types-taggedclaim-15494>`
  
  Convert the claims to UTCTime and tag them\.

.. _function-daml-finance-instrument-generic-util-createfixratepaymentclaimslist-27323:

`createFixRatePaymentClaimsList <function-daml-finance-instrument-generic-util-createfixratepaymentclaimslist-27323_>`_
  \: \[:ref:`SchedulePeriod <type-daml-finance-interface-types-date-schedule-scheduleperiod-76784>`\] \-\> :ref:`PeriodicSchedule <type-daml-finance-interface-types-date-schedule-periodicschedule-97930>` \-\> `Bool <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-bool-66265>`_ \-\> `Decimal <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-decimal-18135>`_ \-\> `Bool <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-bool-66265>`_ \-\> :ref:`DayCountConventionEnum <type-daml-finance-interface-types-date-daycount-daycountconventionenum-67281>` \-\> :ref:`Deliverable <type-daml-finance-interface-claims-types-deliverable-19293>` \-\> \[Claim `Date <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-date-32253>`_ `Decimal <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-decimal-18135>`_ :ref:`Deliverable <type-daml-finance-interface-claims-types-deliverable-19293>` :ref:`Observable <type-daml-finance-interface-claims-types-observable-47872>`\]

.. _function-daml-finance-instrument-generic-util-createfixratepaymentclaims-45471:

`createFixRatePaymentClaims <function-daml-finance-instrument-generic-util-createfixratepaymentclaims-45471_>`_
  \: \[:ref:`SchedulePeriod <type-daml-finance-interface-types-date-schedule-scheduleperiod-76784>`\] \-\> :ref:`PeriodicSchedule <type-daml-finance-interface-types-date-schedule-periodicschedule-97930>` \-\> `Bool <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-bool-66265>`_ \-\> `Decimal <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-decimal-18135>`_ \-\> `Bool <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-bool-66265>`_ \-\> :ref:`DayCountConventionEnum <type-daml-finance-interface-types-date-daycount-daycountconventionenum-67281>` \-\> :ref:`Deliverable <type-daml-finance-interface-claims-types-deliverable-19293>` \-\> :ref:`TaggedClaim <type-daml-finance-interface-claims-types-taggedclaim-15494>`
  
  Calculate a fix rate amount for each payment date and create claims\.

.. _function-daml-finance-instrument-generic-util-createconditionalcreditfixratepaymentclaims-25173:

`createConditionalCreditFixRatePaymentClaims <function-daml-finance-instrument-generic-util-createconditionalcreditfixratepaymentclaims-25173_>`_
  \: \[:ref:`SchedulePeriod <type-daml-finance-interface-types-date-schedule-scheduleperiod-76784>`\] \-\> :ref:`PeriodicSchedule <type-daml-finance-interface-types-date-schedule-periodicschedule-97930>` \-\> `Bool <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-bool-66265>`_ \-\> `Decimal <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-decimal-18135>`_ \-\> `Bool <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-bool-66265>`_ \-\> :ref:`DayCountConventionEnum <type-daml-finance-interface-types-date-daycount-daycountconventionenum-67281>` \-\> :ref:`Deliverable <type-daml-finance-interface-claims-types-deliverable-19293>` \-\> :ref:`Observable <type-daml-finance-interface-claims-types-observable-47872>` \-\> :ref:`TaggedClaim <type-daml-finance-interface-claims-types-taggedclaim-15494>`
  
  Calculate a fix rate amount (if a credit event has not yet happened) for each payment date and create claims\.

.. _function-daml-finance-instrument-generic-util-createcrediteventpaymentclaims-68933:

`createCreditEventPaymentClaims <function-daml-finance-instrument-generic-util-createcrediteventpaymentclaims-68933_>`_
  \: `Bool <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-bool-66265>`_ \-\> :ref:`Deliverable <type-daml-finance-interface-claims-types-deliverable-19293>` \-\> :ref:`Observable <type-daml-finance-interface-claims-types-observable-47872>` \-\> :ref:`Observable <type-daml-finance-interface-claims-types-observable-47872>` \-\> :ref:`PeriodicSchedule <type-daml-finance-interface-types-date-schedule-periodicschedule-97930>` \-\> :ref:`TaggedClaim <type-daml-finance-interface-claims-types-taggedclaim-15494>`
  
  Calculate a (1\-recoveryRate) payment if a credit event just happened and create claims\.

.. _function-daml-finance-instrument-generic-util-createfloatingratepaymentclaims-61051:

`createFloatingRatePaymentClaims <function-daml-finance-instrument-generic-util-createfloatingratepaymentclaims-61051_>`_
  \: \[:ref:`SchedulePeriod <type-daml-finance-interface-types-date-schedule-scheduleperiod-76784>`\] \-\> :ref:`PeriodicSchedule <type-daml-finance-interface-types-date-schedule-periodicschedule-97930>` \-\> `Bool <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-bool-66265>`_ \-\> `Decimal <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-decimal-18135>`_ \-\> `Bool <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-bool-66265>`_ \-\> :ref:`DayCountConventionEnum <type-daml-finance-interface-types-date-daycount-daycountconventionenum-67281>` \-\> :ref:`Deliverable <type-daml-finance-interface-claims-types-deliverable-19293>` \-\> :ref:`Observable <type-daml-finance-interface-claims-types-observable-47872>` \-\> :ref:`TaggedClaim <type-daml-finance-interface-claims-types-taggedclaim-15494>`
  
  Calculate a floating rate amount for each payment date and create claims\.
  The floating rate is always observed on the first day of each payment period and used for the corresponding payment on the last day of that payment period\.
  This means that the calculation agent needs to provide such an Observable, irrespective of
  the kind of reference rate used (e\.g\. a forward looking LIBOR or a backward looking SOFR\-COMPOUND)\.

.. _function-daml-finance-instrument-generic-util-createfxadjustedprincipalclaim-74425:

`createFxAdjustedPrincipalClaim <function-daml-finance-instrument-generic-util-createfxadjustedprincipalclaim-74425_>`_
  \: `Bool <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-bool-66265>`_ \-\> `Decimal <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-decimal-18135>`_ \-\> :ref:`Deliverable <type-daml-finance-interface-claims-types-deliverable-19293>` \-\> `Date <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-date-32253>`_ \-\> :ref:`TaggedClaim <type-daml-finance-interface-claims-types-taggedclaim-15494>`
  
  Create an FX adjusted principal claim\.
  This can be used for both FX swaps (using the appropriate FX rate) and single currency bonds (setting the FX rate to 1\.0)\.

.. _function-daml-finance-instrument-generic-util-datetodateclocktime-38974:

`dateToDateClockTime <function-daml-finance-instrument-generic-util-datetodateclocktime-38974_>`_
  \: `Date <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-date-32253>`_ \-\> `Time <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-time-63886>`_
  
  Maps a ``Date`` to ``Time`` using the rule in the ``DateClock``\.
  From the Daml\.Finance\.Instrument\.Generics\.Test file, but could not import here (duplicated for now)\.
  In the termsheet only date is mentioned, but lifecycle logic is based on time\.

.. _function-daml-finance-instrument-generic-util-mapclaimtoutctime-33526:

`mapClaimToUTCTime <function-daml-finance-instrument-generic-util-mapclaimtoutctime-33526_>`_
  \: Claim `Date <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-date-32253>`_ `Decimal <https://docs.daml.com/daml/stdlib/Prelude.html#type-ghc-types-decimal-18135>`_ :ref:`Deliverable <type-daml-finance-interface-claims-types-deliverable-19293>` :ref:`Observable <type-daml-finance-interface-claims-types-observable-47872>` \-\> :ref:`C <type-daml-finance-interface-claims-types-c-53263>`
  
  Maps a ``Date`` claim to a ``Time`` claim using the rule in the ``DateClock``\.
  From the Daml\.Finance\.Instrument\.Generics\.Test file, but could not import here (duplicated for now)\.
  In the termsheet only date is mentioned, but lifecycle logic is based on time\.

.. _function-daml-finance-instrument-generic-util-processclockupdate-45511:

`processClockUpdate <function-daml-finance-instrument-generic-util-processclockupdate-45511_>`_
  \: IsBond t \=\> :ref:`Parties <type-daml-finance-interface-types-common-parties-68320>` \-\> `ContractId <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-contractid-95282>`_ :ref:`I <type-daml-finance-interface-lifecycle-event-i-17082>` \-\> `ContractId <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-contractid-95282>`_ :ref:`I <type-daml-finance-interface-lifecycle-clock-i-92808>` \-\> `ContractId <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-contractid-95282>`_ :ref:`I <type-daml-finance-interface-lifecycle-rule-lifecycle-i-18685>` \-\> t \-\> \[`ContractId <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-contractid-95282>`_ :ref:`I <type-daml-finance-interface-data-observable-i-4241>`\] \-\> `Update <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-update-68072>`_ (`ContractId <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-contractid-95282>`_ :ref:`I <type-daml-finance-interface-lifecycle-rule-lifecycle-i-18685>`, \[`ContractId <https://docs.daml.com/daml/stdlib/Prelude.html#type-da-internal-lf-contractid-95282>`_ :ref:`I <type-daml-finance-interface-lifecycle-effect-i-11106>`\])
  
  Rule to process a clock update event\.
